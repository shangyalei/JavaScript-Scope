<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>作用域和闭包</title>
</head>
<body>


<!--
 JS中的“圈地运动”----作用域
 1.数据也是有隐私的--我的地盘我做主。
 2.JS中没有代码块---使用函数的运行机制创建。
 3.变量的预解释是在各自的作用域里的预解释。(全局作用域和局部作用域)。

 细节---JS中的顶级作用域使谁
 1.Global对象---你见过上帝吗？
 2.window对象---这是国王，上帝的代理人
 3.Global的属性（见高程三133页）；
 并非所有的内置对象都是window的对象属性，知道好。例如：Object,String,Number,Boolean,Math,Function和Window同一个级别的对象。
 因为前端里面，代码是跑在浏览器里面的所以window是全局变量对象。



 变量和属性又什么关系？
 1.全局变量是window的属性
 2.window的属性也可以看做全局变量
 3.属性是以这个作用域为对象的变量。
 4.对象的属性，也可以看做以这个对象为作用域的变量，也就是所我可以把一个对象看做一个作用域。
 5.对象是作用域，那么作用域也可以是对象。

 活动对象
 1.函数的运行是个有生命周期的内存地址。
 2.或者说：函数运行时，会创建一个内存地址，当此函数运行结束时，此内存地址又会销毁。这个地址我们无法保存，它是灵活的、活动的、有生命周期的。
 3.函数里的变量，就是在这个内存里创建，我们可以把这个内存当成一个对象，那函数里的变量就是这个对象的属性。
 4.严重的理解函数的定义和函数的运行。
 5.也就是说，函数定义的会开辟一个内存地址，当函数运行时，又会创建一个内存空间来运行。
 6.活动对象也就是函数运行时产生的作用域，供函数执行的私有环境，这个块内存我们没法保存，也就是说没办法把它赋值给一个变量。因为它是活动的有生命
 周期的，即使定义给了变量，我们也找不到。所以函数运行时的作用域没有名字，运行完就结束。
 7.一个函数的多次运行，每一次都会产生一个私有的作用域，每一个作用域是老死不行往来的。




 不销毁活动对象（作用域）---闭包
 1.可以简单的理解为作用域就是闭包。
 2.闭包是机制，而不是形式，不是概念。并不是说长什么样的就是闭包。国家无论大小都是国家。
 3.不同教材上对闭包的解释不同。
 4.《高程3》第192页小结中的解释。
 5.《权威指南》第182页中对闭包的解释。
 6.使用闭包，还不如直接说使用一个作用域，实在人不用闭包这个概念！（程序员自我的修养--不吓唬人）
 7.最大的闭包就是window这个作用域，就像我们人类生存在大气层里。
 8.我们每天都在使用闭包，因为最大的作用域就是window。
 9.这个函数的作用域是谁的是函数定义的时候决定的。和函数在哪里运行没有关系。
 10.也就是说在哪里运行改变不了作用域链查找的顺序。
 11.只要扯到闭包上肯定和作用域有关系，肯定和作用域链有关系。


 -->

<div id="div1"></div>

<script>

    function fn() {
        var n=9;
    }
    //下面的每一个方法，都会产生一个私有作用域，里面的变量n老死不行往来
    fn();
    fn();
    //alert(n);//在当前作用找不到


    //保护变量可以使用匿名函数形成了一个代码块的作用域。
    (function () {
        var n=10;
    })();


    //面试题  考察作用域查找，变量预解释是各自作用域里的预解释。
    var m=9;
    var s="abcd";
    var f='window';
    function fn1() {
        alert(m);
        alert(s);
        m=7;
        var m=6;
        var f='fn-f';

        function inner() {
            alert(m);
            alert(s);
            alert(f);
            var f='f';
        }
        inner();
    }
    fn1();//运行这个函数，会输出什么结果？
    //注意：函数里面可以套函数的，但是作用域查找的时间越长，性能越差。函数只有运行，函数体内的代码才起作用。


    //考点：对象可以看做一个作用域
    var ele=document.getElementById('div1');
    //ele.style.width='100px';
    //ele.style.height='200px';
    //backgroundColor='green';
    var height="400px";
    with(ele.style){//把ele.style当做单独的内存块划出来，也就是说JS通过分成好多作用域块来管理的，window是大作用域块，其它的是小作用域块。作用域就是内存块。
        width='100px';
        //height='200px';
        backgroundColor='green';
        alert(height);//这里面的变量看做这个作用域的属性。属性没有为空。
        alert(window.height);
        //var mm=999;里面的声明不必加var，加上var就按照正常的预解释去做了。也不会注册给ele.style
    }
    //不建议使用with语句，容易造成，作用域混乱，但是通过这个例子可以看到对象也是可以看做一个作用域块的。


    //思考：
    function fn3() {
        var a=9;

    }
    //fn3里的a又是谁的属性呢？ 首先运行才能产生a,所以先运行fn3();
    //若果a是fn3的属性岂不是alert(fn3.a);会弹出9吗？

    fn3();
    alert(fn3.a);



</script>




</body>
</html>